import{o,c as l,b as e,d as b,n as M,r as y,e as T,F as C,f as A,u as x,w as O,g as f,h as R,t as m,i as J,j as S,k as B,v as V,l as P,T as U,m as L,q as Z,s as q,x as z,y as G,z as H,A as N,p as K,a as Q,B as W}from"./index-BxQ8N2wr.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";function X(v,d){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M20.25 8.511c.884.284 1.5 1.128 1.5 2.097v4.286c0 1.136-.847 2.1-1.98 2.193-.34.027-.68.052-1.02.072v3.091l-3-3c-1.354 0-2.694-.055-4.02-.163a2.115 2.115 0 0 1-.825-.242m9.345-8.334a2.126 2.126 0 0 0-.476-.095 48.64 48.64 0 0 0-8.048 0c-1.131.094-1.976 1.057-1.976 2.192v4.286c0 .837.46 1.58 1.155 1.951m9.345-8.334V6.637c0-1.621-1.152-3.026-2.76-3.235A48.455 48.455 0 0 0 11.25 3c-2.115 0-4.198.137-6.24.402-1.608.209-2.76 1.614-2.76 3.235v6.226c0 1.621 1.152 3.026 2.76 3.235.577.075 1.157.14 1.74.194V21l4.155-4.155"})])}function Y(v,d){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"})])}function ee(v,d){return o(),l("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"})])}const se={xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 25",version:"1.1"},te=b({__name:"IconSwitch",props:{open:{}},setup(v){return(d,c)=>(o(),l("svg",se,[e("path",{fill:"transparent",class:M({open:v.open})},null,2)]))}}),ne=j(te,[["__scopeId","data-v-320dcc6c"]]),ae={class:"chat_group"},oe=["onDrop"],le=["onClick"],ce={class:"group_icon"},ie={class:"group_hide"},re=["onDragstart"],de=e("div",{class:"chat_icon"},null,-1),_e={class:"chat_table"},ue={class:"chat_tip"},he={class:"last_time"},pe={class:"new_msg"},ve=b({__name:"ChatGroup",setup(v){let d=y([{name:"全部",list:Array.from(Array(10),(_,p)=>({name:"好友",lastTime:"12-15",newMsg:"1"})),open:!1},{name:"群聯",list:Array.from(Array(10),(_,p)=>({name:"好友",lastTime:"12-15",newMsg:"1"})),open:!1},{name:"好友1",list:Array.from(Array(10),(_,p)=>({name:"好友",lastTime:"12-15",newMsg:"1"})),open:!1},{name:"好友2",list:Array.from(Array(10),(_,p)=>({name:"好友",lastTime:"12-15",newMsg:"1"})),open:!1},{name:"好友3",list:Array.from(Array(10),(_,p)=>({name:"好友",lastTime:"12-15",newMsg:"1"})),open:!1}]);T(()=>{});const c=_=>{_.open=!_.open},t=y(null);let i=null;const n=(_,p)=>{i?(t.value[p].querySelector(".group_list .group_hide").appendChild(i),i=null,a.value=""):(console.log(_.dataTransfer,p),Array.from(_.dataTransfer.items,h=>{console.log(h),h.kind=="file"?console.log("getAsFile",h.getAsFile()):h.kind==="string"&&h.getAsString(g=>{console.log("getAsString",g)})})),_.preventDefault()},a=y(""),u=(_,p)=>{i=_.target,a.value=p};return(_,p)=>(o(),l("div",ae,[(o(!0),l(C,null,A(x(d),(h,g)=>(o(),l("div",{class:"group_item",ref_for:!0,ref_key:"groupItem",ref:t,key:h.name,onDrop:O(w=>n(w,g),["stop"]),onDragover:p[0]||(p[0]=O(()=>{},["prevent"]))},[e("div",{class:"group_table",onClick:w=>c(h)},[e("div",ce,[f(x(X))]),R(" "+m(h.name)+" ",1),e("div",{class:M(["switch_icon",{open:h.open}])},[f(ne,{open:h.open},null,8,["open"])],2)],8,le),e("div",{class:M(["group_list",{open:h.open}])},[e("div",ie,[(o(!0),l(C,null,A(h.list,(w,$)=>(o(),l("div",{class:M(["chat_item",{active:`${g}_${$}`===a.value}]),draggable:"true",onDragstart:I=>u(I,`${g}_${$}`),key:g},[de,e("div",_e,m(w.name)+m(`${g}_${$}`),1),e("div",ue,[e("div",he,m(w.lastTime),1),e("div",pe,m(w.newMsg),1)])],42,re))),128))])],2)],40,oe))),128))]))}}),me={class:"search"},ge={class:"search_input"},fe={class:"search_icon"},we={key:0,class:"search_result"},ye={class:"search_result_table"},$e={class:"search_result_list"},ke={key:0,class:"search_item_user"},Se=e("div",{class:"search_user_icon"},null,-1),Ce={class:"search_user_name"},Ae={key:1,class:"search_item_group"},xe=e("div",{class:"search_user_icon"},null,-1),be={class:"search_user_name"},Me={key:2,class:"search_item_history"},Le={class:"history_user_info"},Te=e("div",{class:"history_user_icon"},null,-1),De={class:"history_user_name"},Ie={class:"history_number"},Ne=b({__name:"Search",setup(v){const d=y(""),c=[{type:1,table:"联系人",list:Array.from(Array(10),(i,n)=>({id:n,name:`名字${n}`}))},{type:2,table:"群组",list:Array.from(Array(10),(i,n)=>({id:n,name:`群组${n}`}))},{type:3,table:"聊天记录",list:Array.from(Array(10),(i,n)=>({id:n,name:`名字${n}`,history:[`聊天记录${n}`]}))}],t=y(!1);return J(d,i=>{t.value=!!i},{immediate:!0}),(i,n)=>(o(),l("div",me,[t.value?(o(),l("div",{key:0,class:"search_mask",onClick:n[0]||(n[0]=O(a=>t.value=!1,["self"]))})):S("",!0),e("div",ge,[B(e("input",{type:"text",placeholder:"查找","onUpdate:modelValue":n[1]||(n[1]=a=>d.value=a)},null,512),[[V,d.value]]),e("div",fe,[f(x(ee))])]),f(U,{duration:100},{default:P(()=>[t.value?(o(),l("div",we,[(o(),l(C,null,A(c,a=>e("div",{class:"search_result_group",key:a.type},[e("div",ye,m(a.table),1),e("div",$e,[(o(!0),l(C,null,A(a.list,u=>(o(),l("div",{class:"search_result_list_item",key:u.id},[a.type===1?(o(),l("div",ke,[Se,e("div",Ce,m(u.name),1)])):S("",!0),a.type===2?(o(),l("div",Ae,[xe,e("div",be,m(u.name),1)])):S("",!0),a.type===3?(o(),l("div",Me,[e("div",Le,[Te,e("div",De,m(u.name),1)]),e("div",Ie,[R("相关记录 "),e("span",null,m(u.history.length),1),R(" 条")])])):S("",!0)]))),128))])])),64))])):S("",!0)]),_:1})]))}}),Oe={class:"chat_log",ref:"chatLogEl"},Re=e("div",{class:"chat_icon"},null,-1),Be={class:"chat_tip"},Je={class:"chat_user_name"},Ve={class:"last_time"},je={class:"new_msg"},Ee={__name:"ChatLog",setup(v){const d=L("dataStore");let c=Z(()=>d.chatLog);return J(c,()=>{console.log(c.value)},{deep:!0,immediate:!0}),T(()=>{}),(t,i)=>(o(),l("div",Oe,[(o(!0),l(C,null,A(x(c),(n,a)=>(o(),l("div",{class:"chat_item",key:a},[Re,e("div",Be,[e("div",Je,m(n.name),1),e("div",Ve,m(n.lastTime),1),e("div",je,m(n.newMsg),1)])]))),128))],512))}},Fe={class:"chat_ctrl"},Pe=e("div",{class:"chat_tools"},null,-1),Ue={class:"chat_input"},Ze={class:"chat_send"},qe={class:"chat_send"},ze=e("div",null,"被连接端",-1),Ge=e("div",null,"连接端",-1),He=b({__name:"ChatCtrl",setup(v){L("popupStore");const d=L("dataStore"),c=y("");let t=null,i=null,n=null;function a(){return t=new RTCPeerConnection({iceServers:[{urls:"stun:stun.l.google.com:19302"}]}),t.addEventListener("icegatheringstatechange",s=>{switch(t.iceGatheringState){case"new":console.log("new",s);break;case"gathering":console.log("gathering",s);break;case"complete":console.log("complete",s);break}}),t.onicecandidate=s=>{const r={type:"candidate",candidate:null};s.candidate&&(r.candidate=s.candidate.candidate,r.sdpMid=s.candidate.sdpMid,r.sdpMLineIndex=s.candidate.sdpMLineIndex,d.chatLog.push({name:"连接端",lastTime:new Date().toLocaleString(),newMsg:JSON.stringify(r)})),console.log("onicecandidate",s,r)},t}function u(){const s=i.readyState;console.log("Send channel state is: "+s)}function _(s){console.log("Received Message",s)}const p=async()=>{await a(),i=t.createDataChannel("sendDataChannel"),i.onopen=u,i.onmessage=_,i.onclose=u;const s=await t.createOffer();console.log(s),d.chatLog.push({name:"连接端",lastTime:new Date().toLocaleString(),newMsg:JSON.stringify(s)}),await t.setLocalDescription(s)};function h(s){console.log("Received Message",s.data)}function g(){const s=n.readyState;console.log(`Receive channel state is: ${s}`)}function w(s){console.log("Receive Channel Callback"),n=s.channel,n.onmessage=h,n.onopen=g,n.onclose=g}const $=async s=>{if(console.log("连接其它"),t){console.error("existing peerconnection");return}await a(),t.ondatachannel=w,await t.setRemoteDescription(JSON.parse(s));const r=await t.createAnswer();console.log({type:"answer",sdp:r.sdp}),d.chatLog.push({name:"连接端",lastTime:new Date().toLocaleString(),newMsg:JSON.stringify({type:"answer",sdp:r.sdp})}),c.value="",await t.setLocalDescription(r)},I=async s=>{if(console.log("onAnswer",s),!t){console.error("no peerconnection");return}c.value="",await t.setRemoteDescription(JSON.parse(s))},E=async s=>{if(s=JSON.parse(s),console.log("onCandidate",s),!t){console.error("no peerconnection");return}s.candidate?await t.addIceCandidate(s):await t.addIceCandidate(null),c.value=""};function F(s){d.sendData(s),i.send(s)}return T(async()=>{}),(s,r)=>(o(),l("div",Fe,[Pe,e("div",Ue,[B(e("textarea",{"onUpdate:modelValue":r[0]||(r[0]=k=>c.value=k),name:"",id:"",cols:"30",rows:"10"},null,512),[[V,c.value]])]),e("div",Ze,[e("div",{class:"send_btn",onClick:r[1]||(r[1]=k=>F(c.value))},"发送")]),e("div",qe,[e("div",null,[ze,e("div",{class:"send_btn",onClick:p},"start"),e("div",{class:"send_btn",onClick:r[2]||(r[2]=k=>I(c.value))},"answer")]),e("div",null,[Ge,e("div",{class:"send_btn",onClick:r[3]||(r[3]=k=>$(c.value))},"offer"),e("div",{class:"send_btn",onClick:r[4]||(r[4]=k=>E(c.value))},"candidate")])])]))}}),D=v=>(K("data-v-0e9ce54b"),v=v(),Q(),v),Ke={class:"home"},Qe={class:"home_left_panel"},We=D(()=>e("div",{class:"logo"},null,-1)),Xe={class:"user_info"},Ye=D(()=>e("div",{class:"user_icon"},null,-1)),es=D(()=>e("div",{class:"user_name"},[e("p",null,"衝衝衝"),e("p",null,"1")],-1)),ss={class:"setting"},ts={class:"module_group"},ns=D(()=>e("div",{class:"home_tab"},[e("div"),e("div"),e("div")],-1)),as={class:"home_right_panel"},os=b({__name:"home",setup(v){q(()=>{z.getData({id:100143}).then(a=>{console.log("123456",a)})});let d=G();L("popupStore"),y(0),H([{name:"群聯1",list:Array.from(Array(20),(a,u)=>u),open:!1},{name:"好友",list:Array.from(Array(20),(a,u)=>u),open:!1}]);let c=y(null),t=N("offer"),i=N("uuid"),n=N("candidate");return T(async()=>{t&&n&&d.createSender(JSON.parse(t),JSON.parse(n),i),c.value}),(a,u)=>(o(),l("div",Ke,[B(e("div",Qe,[We,e("div",Xe,[Ye,es,e("div",ss,[f(x(Y),{class:"custom-class"})])]),e("div",ts,[f(Ne),f(ve)]),ns],512),[[W,!1]]),e("div",as,[f(Ee),f(He)])]))}}),is=j(os,[["__scopeId","data-v-0e9ce54b"]]);export{is as default};
